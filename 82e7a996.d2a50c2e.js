(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{118:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return m}));var r=a(0),n=a.n(r);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},c=Object.keys(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=n.a.createContext({}),p=function(e){var t=n.a.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},s=function(e){var t=p(e.components);return n.a.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},d=n.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,c=e.originalType,o=e.parentName,i=b(e,["components","mdxType","originalType","parentName"]),s=p(a),d=r,m=s["".concat(o,".").concat(d)]||s[d]||u[d]||c;return a?n.a.createElement(m,l(l({ref:t},i),{},{components:a})):n.a.createElement(m,l({ref:t},i))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=a.length,o=new Array(c);o[0]=d;var l={};for(var b in t)hasOwnProperty.call(t,b)&&(l[b]=t[b]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var i=2;i<c;i++)o[i]=a[i];return n.a.createElement.apply(null,o)}return n.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"},96:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return b})),a.d(t,"default",(function(){return p}));var r=a(3),n=a(7),c=(a(0),a(118)),o={id:"core",title:"Core"},l={unversionedId:"core",id:"core",isDocsHomePage:!1,title:"Core",description:"Build Status",source:"@site/servicios/core.mdx",slug:"/core",permalink:"/servicios/core",editUrl:"https://github.com/bookBnB/bookBnB.github.io/edit/doc/servicios/core.mdx",version:"current",sidebar:"servicios",previous:{title:"Back Office",permalink:"/servicios/back-office"},next:{title:"Usuarios",permalink:"/servicios/usuarios"}},b=[{value:"Ambientes",id:"ambientes",children:[]},{value:"Instalaci\xf3n",id:"instalaci\xf3n",children:[{value:"Imagen",id:"imagen",children:[]},{value:"Despligue",id:"despligue",children:[]},{value:"Build",id:"build",children:[]},{value:"Tests",id:"tests",children:[]}]},{value:"Configuraci\xf3n",id:"configuraci\xf3n",children:[]},{value:"Cobertura",id:"cobertura",children:[]},{value:"Arquitectura",id:"arquitectura",children:[]},{value:"OpenApi",id:"openapi",children:[]}],i={rightToc:b};function p(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},i,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://travis-ci.com/BookBnB/core"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://travis-ci.com/BookBnB/core.svg?branch=master",alt:"Build Status"}))),"\n",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://codecov.io/gh/BookBnB/core"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://codecov.io/gh/BookBnB/core/branch/master/graph/badge.svg?token=3HYQW6VBPY",alt:"codecov"}))),"\n",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://bookbnb-master.herokuapp.com/"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://img.shields.io/badge/heroku-master-success.svg?l?style=flat&logo=heroku&logoColor=white&labelColor=494998",alt:"Heroku"}))),"\n",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://bookbnb-develop.herokuapp.com/"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://img.shields.io/badge/heroku-develop-success.svg?l?style=flat&logo=heroku&logoColor=white&labelColor=494998",alt:"Heroku"})))),Object(c.b)("p",null,"Este es el servicio principal de Back-End de bookBnB. Contiene la l\xf3gica principal de negocio para la mayor parte de las funciones. "),Object(c.b)("h2",{id:"ambientes"},"Ambientes"),Object(c.b)("p",null,"Se encuentra desplegado en un ambiente productivo y otro interno del equipo de desarrollo para testing:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://bookbnb-master.herokuapp.com/"}),"Producci\xf3n")," con del\xedvery continuo a partir de la rama ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/BookBnB/core/tree/master"}),"master"),"."),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://bookbnb-develop.herokuapp.com/"}),"Desarrollo")," con del\xedvery continuo a partir de la rama ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/BookBnB/core/tree/develop"}),"develop"),".")),Object(c.b)("h2",{id:"instalaci\xf3n"},"Instalaci\xf3n"),Object(c.b)("p",null,"Dado que la aplicaci\xf3n se encuentra dockerizada la instalaci\xf3n es tan sencilla como:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ git clone git@github.com:BookBnB/core.git\n$ cd core\n$ docker-compose up -d\n")),Object(c.b)("p",null,"Luego para conectarse a la app:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ docker-compose exec app bash\n")),Object(c.b)("h3",{id:"imagen"},"Imagen"),Object(c.b)("p",null,"Para crear una imagen de docker con el estado actual de la aplicaci\xf3n se debe ejecutar:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ docker/build_production_image.sh\n")),Object(c.b)("p",null,"Esto crear\xe1 una imagen con el tag ",Object(c.b)("inlineCode",{parentName:"p"},"bookbnb:latest"),"."),Object(c.b)("h3",{id:"despligue"},"Despligue"),Object(c.b)("p",null,"Luego para desplegar la imagen en Heroku:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ docker/heroku_push.sh\n")),Object(c.b)("p",null,"Es necesario que para ello se encuentre configurada la variable de ambiente ",Object(c.b)("inlineCode",{parentName:"p"},"$TRAVIS_BRANCH")," indicando la rama que se desea desplegar."),Object(c.b)("h3",{id:"build"},"Build"),Object(c.b)("p",null,"Para compilar la aplicaci\xf3n:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ npm run build             # one time\n$ npm run build:watch       # fast recompile on file changes\n")),Object(c.b)("h3",{id:"tests"},"Tests"),Object(c.b)("p",null,"Para ejecutar los tests:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ npm run test              # all tests, no coverage\n$ npm run test:unit         # unit tests only\n$ npm run test:acceptance   # acceptance tests only\n$ npm run test:coverage     # all tests, with coverage\n")),Object(c.b)("h2",{id:"configuraci\xf3n"},"Configuraci\xf3n"),Object(c.b)("p",null,"Se deben configurar las siguientes variables de ambiente:"),Object(c.b)("table",null,Object(c.b)("thead",{parentName:"table"},Object(c.b)("tr",{parentName:"thead"},Object(c.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"variable"),Object(c.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"descripci\xf3n"))),Object(c.b)("tbody",{parentName:"table"},Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"ALGOLIA_ADMIN_API_KEY"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Api key de Algolia")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"ALGOLIA_APPLICATION_ID"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Id de aplicaci\xf3n en Algolia")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"BACKOFFICE_URL"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Url del front-end del backoffice")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"USERS_SERVICE_URL"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Url del servicio de usuarios")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"DATABASE_URL"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Url de conexi\xf3n a la base de datos")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"NODE_ENV"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Ambiente en el que se encuentra")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"SECRET_KEY"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Clave random para generar tokens")))),Object(c.b)("h2",{id:"cobertura"},"Cobertura"),Object(c.b)("p",null,"El proyecto fue testeado con pruebas unitarias y de integraci\xf3n utilizando ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://cucumber.io/docs/gherkin/"}),"Gherkin")," logrando una cobertura mayor al 90%. Se puede ver el detalle de los reportes en ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://codecov.io/gh/BookBnB/core"}),"codecov"),"."),Object(c.b)("img",{alt:"Arquitectura",src:"https://codecov.io/gh/BookBnB/core/branch/develop/graph/sunburst.svg",style:{margin:"15px auto",display:"flex"}}),Object(c.b)("h2",{id:"arquitectura"},"Arquitectura"),Object(c.b)("p",null,"Este microservicio utiliza una ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://alistair.cockburn.us/hexagonal-architecture/"}),"arquitectura hexagonal")," para mantener desacoplada la l\xf3gica de negocio con el resto de las conexiones del servicio."),Object(c.b)("h2",{id:"openapi"},"OpenApi"),Object(c.b)("p",null,"Puede consultarse la especificaci\xf3n OpenApi en ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://bookbnb-master.herokuapp.com/v1/api.json"}),"api.json")," o utilizando swagger en ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://bookbnb-master.herokuapp.com/v1/api-docs"}),"api-docs"),"."),Object(c.b)("iframe",{src:"https://bookbnb-master.herokuapp.com/v1/api-docs",frameBorder:"0",allowFullScreen:!0,style:{width:"100%",height:"500px"}}))}p.isMDXComponent=!0}}]);