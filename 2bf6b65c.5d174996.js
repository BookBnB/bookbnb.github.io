(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{118:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return O}));var r=a(0),n=a.n(r);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},c=Object.keys(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)a=c[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var b=n.a.createContext({}),s=function(e){var t=n.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=s(e.components);return n.a.createElement(b.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},d=n.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,c=e.originalType,l=e.parentName,b=o(e,["components","mdxType","originalType","parentName"]),u=s(a),d=r,O=u["".concat(l,".").concat(d)]||u[d]||p[d]||c;return a?n.a.createElement(O,i(i({ref:t},b),{},{components:a})):n.a.createElement(O,i({ref:t},b))}));function O(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var c=a.length,l=new Array(c);l[0]=d;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var b=2;b<c;b++)l[b]=a[b];return n.a.createElement.apply(null,l)}return n.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"},77:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return o})),a.d(t,"default",(function(){return s}));var r=a(3),n=a(7),c=(a(0),a(118)),l={id:"usuarios",title:"Usuarios"},i={unversionedId:"usuarios",id:"usuarios",isDocsHomePage:!1,title:"Usuarios",description:"Build Status",source:"@site/servicios/usuarios.mdx",slug:"/usuarios",permalink:"/servicios/usuarios",editUrl:"https://github.com/bookBnB/bookBnB.github.io/edit/doc/servicios/usuarios.mdx",version:"current",sidebar:"servicios",previous:{title:"Core",permalink:"/servicios/core"},next:{title:"Pagos",permalink:"/servicios/pagos"}},o=[{value:"Ambientes",id:"ambientes",children:[]},{value:"Instalaci\xf3n",id:"instalaci\xf3n",children:[{value:"Imagen",id:"imagen",children:[]},{value:"Despliegue",id:"despliegue",children:[]},{value:"Ejecuci\xf3n",id:"ejecuci\xf3n",children:[]},{value:"Tests",id:"tests",children:[]}]},{value:"Configuraci\xf3n",id:"configuraci\xf3n",children:[]},{value:"Cobertura",id:"cobertura",children:[]},{value:"OpenApi",id:"openapi",children:[]}],b={rightToc:o};function s(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://travis-ci.com/BookBnB/users-service"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://travis-ci.com/BookBnB/users-service.svg?branch=master",alt:"Build Status"}))),"\n",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://codecov.io/gh/BookBnB/users-service"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://codecov.io/gh/BookBnB/users-service/branch/master/graph/badge.svg?token=3HYQW6VBPY",alt:"codecov"}))),"\n",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://users-service-master.herokuapp.com/"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://img.shields.io/badge/heroku-master-success.svg?l?style=flat&logo=heroku&logoColor=white&labelColor=494998",alt:"Heroku"}))),"\n",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://users-service-develop.herokuapp.com/"}),Object(c.b)("img",Object(r.a)({parentName:"a"},{src:"https://img.shields.io/badge/heroku-develop-success.svg?l?style=flat&logo=heroku&logoColor=white&labelColor=494998",alt:"Heroku"})))),Object(c.b)("p",null,"Este es el servicio de usuarios de Back-End de bookBnB. Contiene la l\xf3gica vinculada a la administraci\xf3n y autenticaci\xf3n de usuarios."),Object(c.b)("h2",{id:"ambientes"},"Ambientes"),Object(c.b)("p",null,"Se encuentra desplegado en un ambiente productivo y otro interno del equipo de desarrollo para testing:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://users-service-master.herokuapp.com/"}),"Producci\xf3n")," con del\xedvery continuo a partir de la rama ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/BookBnB/users-service/tree/master"}),"master"),"."),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://users-service-develop.herokuapp.com/"}),"Desarrollo")," con del\xedvery continuo a partir de la rama ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://github.com/BookBnB/users-service/tree/develop"}),"develop"),".")),Object(c.b)("h2",{id:"instalaci\xf3n"},"Instalaci\xf3n"),Object(c.b)("p",null,"Dado que la aplicaci\xf3n se encuentra dockerizada la instalaci\xf3n es tan sencilla como:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ git clone git@github.com:BookBnB/users-service.git\n$ cd users-service\n$ docker-compose up -d\n")),Object(c.b)("p",null,"Luego para conectarse a la app:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ docker-compose exec app bash\n")),Object(c.b)("h3",{id:"imagen"},"Imagen"),Object(c.b)("p",null,"Para crear una imagen de docker con el estado actual de la aplicaci\xf3n se debe ejecutar:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ docker/build_production_image.sh\n")),Object(c.b)("p",null,"Esto crear\xe1 una imagen con el tag ",Object(c.b)("inlineCode",{parentName:"p"},"users-service:latest"),"."),Object(c.b)("h3",{id:"despliegue"},"Despliegue"),Object(c.b)("p",null,"Luego para desplegar la imagen en Heroku:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ docker/heroku_push.sh\n")),Object(c.b)("p",null,"Es necesario que para ello se encuentre configurada la variable de ambiente ",Object(c.b)("inlineCode",{parentName:"p"},"$TRAVIS_BRANCH")," indicando la rama que se desea desplegar."),Object(c.b)("h3",{id:"ejecuci\xf3n"},"Ejecuci\xf3n"),Object(c.b)("p",null,"Para ejecutar la aplicaci\xf3n:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ ./run.sh\n")),Object(c.b)("h3",{id:"tests"},"Tests"),Object(c.b)("p",null,"Para ejecutar los tests:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"$ python -m pytest tests\n")),Object(c.b)("h2",{id:"configuraci\xf3n"},"Configuraci\xf3n"),Object(c.b)("p",null,"Se deben configurar las siguientes variables de ambiente:"),Object(c.b)("table",null,Object(c.b)("thead",{parentName:"table"},Object(c.b)("tr",{parentName:"thead"},Object(c.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"variable"),Object(c.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"descripci\xf3n"))),Object(c.b)("tbody",{parentName:"table"},Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"DATABASE_URL"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Url de conexi\xf3n a la base de datos")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"SECRET_KEY"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Clave random para generar tokens")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"BACKOFFICE_URL"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Url del front-end del backoffice")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"SESSION_TOKEN_DURATION"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Duraci\xf3n del token de sesi\xf3n")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"GOOGLE_CLIENT_ID"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Id de aplicaci\xf3n de Google")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"MAIL_USERNAME"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Direcci\xf3n email para recuperaci\xf3n de contrase\xf1a")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"MAIL_PASSWORD"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Contrase\xf1a del email de recuperaci\xf3n")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"MAIL_DEFAULT_SENDER"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Direcci\xf3n default de donde enviar correos de recuperaci\xf3n")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"MAIL_SERVER"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Direcci\xf3n del servidor SMTP (Default: smtp.google.com)")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"MAIL_PORT"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Puerto del servidor SMTP (Default: 465)")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"MAIL_USE_SSL"),Object(c.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Indica si usar SSL al comunicarse con el servidor SMTP (Default: True)")))),Object(c.b)("h2",{id:"cobertura"},"Cobertura"),Object(c.b)("p",null,"El proyecto fue testeado a trav\xe9s del m\xf3dulo pytest, logrando una cobertura mayor al 90%. Se puede ver el detalle de los reportes en ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://codecov.io/gh/BookBnB/users-service"}),"codecov"),"."),Object(c.b)("img",{alt:"Pruebas",src:"https://codecov.io/gh/BookBnB/users-service/branch/develop/graph/sunburst.svg",style:{margin:"15px auto",display:"flex"}}),Object(c.b)("h2",{id:"openapi"},"OpenApi"),Object(c.b)("p",null,"Puede consultarse la especificaci\xf3n OpenApi en ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://users-service-master.herokuapp.com/v1/api.json"}),"api.json")," o utilizando swagger en ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://users-service-master.herokuapp.com/v1/api-docs"}),"api-docs"),"."),Object(c.b)("iframe",{src:"https://users-service-master.herokuapp.com/v1/api-docs",frameBorder:"0",allowFullScreen:!0,style:{width:"100%",height:"500px"}}))}s.isMDXComponent=!0}}]);