(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{107:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return o})),a.d(t,"metadata",(function(){return i})),a.d(t,"rightToc",(function(){return l})),a.d(t,"default",(function(){return s}));var n=a(3),r=a(7),c=(a(0),a(118)),o={id:"pagos",title:"Pagos"},i={unversionedId:"pagos",id:"pagos",isDocsHomePage:!1,title:"Pagos",description:"Build Status",source:"@site/servicios/pagos.mdx",slug:"/pagos",permalink:"/servicios/pagos",editUrl:"https://github.com/bookBnB/bookBnB.github.io/edit/doc/servicios/pagos.mdx",version:"current",sidebar:"servicios",previous:{title:"Usuarios",permalink:"/servicios/usuarios"}},l=[{value:"Ambientes",id:"ambientes",children:[]},{value:"Instalaci\xf3n",id:"instalaci\xf3n",children:[{value:"Imagen",id:"imagen",children:[]},{value:"Despligue",id:"despligue",children:[]},{value:"Build",id:"build",children:[]},{value:"Tests",id:"tests",children:[]}]},{value:"Configuraci\xf3n",id:"configuraci\xf3n",children:[]},{value:"Cobertura",id:"cobertura",children:[]},{value:"Arquitectura",id:"arquitectura",children:[]},{value:"OpenApi",id:"openapi",children:[]}],b={rightToc:l};function s(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(n.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://travis-ci.com/BookBnB/payments-service"}),Object(c.b)("img",Object(n.a)({parentName:"a"},{src:"https://travis-ci.com/BookBnB/payments-service.svg?branch=master",alt:"Build Status"}))),"\n",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://codecov.io/gh/BookBnB/payments-service"}),Object(c.b)("img",Object(n.a)({parentName:"a"},{src:"https://codecov.io/gh/BookBnB/payments-service/branch/master/graph/badge.svg?token=3HYQW6VBPY",alt:"codecov"}))),"\n",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://payments-service-master.herokuapp.com/"}),Object(c.b)("img",Object(n.a)({parentName:"a"},{src:"https://img.shields.io/badge/heroku-master-success.svg?l?style=flat&logo=heroku&logoColor=white&labelColor=494998",alt:"Heroku"}))),"\n",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://payments-service-develop.herokuapp.com/"}),Object(c.b)("img",Object(n.a)({parentName:"a"},{src:"https://img.shields.io/badge/heroku-develop-success.svg?l?style=flat&logo=heroku&logoColor=white&labelColor=494998",alt:"Heroku"})))),Object(c.b)("p",null,"Este es el servicio de pagos de Back-End de bookBnB. Nuclea aquellas funcionalidades vinculadas a las interacciones y pagos con el contrato inteligente desplegado en la blockchain Ethereum."),Object(c.b)("h2",{id:"ambientes"},"Ambientes"),Object(c.b)("p",null,"Se encuentra desplegado en un ambiente productivo y otro interno del equipo de desarrollo para testing:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(n.a)({parentName:"li"},{href:"https://payments-service-master.herokuapp.com/"}),"Producci\xf3n")," con del\xedvery continuo a partir de la rama ",Object(c.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/BookBnB/payments-service/tree/master"}),"master"),"."),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",Object(n.a)({parentName:"li"},{href:"https://payments-service-develop.herokuapp.com/"}),"Desarrollo")," con del\xedvery continuo a partir de la rama ",Object(c.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/BookBnB/payments-service/tree/develop"}),"develop"),".")),Object(c.b)("h2",{id:"instalaci\xf3n"},"Instalaci\xf3n"),Object(c.b)("p",null,"Dado que la aplicaci\xf3n se encuentra dockerizada la instalaci\xf3n es tan sencilla como:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ git clone git@github.com:BookBnB/payments-service.git\n$ cd payments-service\n$ docker-compose up -d\n")),Object(c.b)("p",null,"Luego para conectarse a la app:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ docker-compose exec app bash\n")),Object(c.b)("h3",{id:"imagen"},"Imagen"),Object(c.b)("p",null,"Para crear una imagen de docker con el estado actual de la aplicaci\xf3n se debe ejecutar:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ docker/build_production_image.sh\n")),Object(c.b)("p",null,"Esto crear\xe1 una imagen con el tag ",Object(c.b)("inlineCode",{parentName:"p"},"payments-service:latest"),"."),Object(c.b)("h3",{id:"despligue"},"Despligue"),Object(c.b)("p",null,"Luego para desplegar la imagen en Heroku:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ docker/heroku_push.sh\n")),Object(c.b)("p",null,"Es necesario que para ello se encuentre configurada la variable de ambiente ",Object(c.b)("inlineCode",{parentName:"p"},"$TRAVIS_BRANCH")," indicando la rama que se desea desplegar."),Object(c.b)("h3",{id:"build"},"Build"),Object(c.b)("p",null,"Para compilar la aplicaci\xf3n:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ npm run build             # one time\n$ npm run build:watch       # fast recompile on file changes\n")),Object(c.b)("h3",{id:"tests"},"Tests"),Object(c.b)("p",null,"Para ejecutar los tests:"),Object(c.b)("pre",null,Object(c.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"$ npm run test              # all tests, no coverage\n$ npm run test:unit         # unit tests only\n$ npm run test:acceptance   # acceptance tests only\n$ npm run test:coverage     # all tests, with coverage\n")),Object(c.b)("h2",{id:"configuraci\xf3n"},"Configuraci\xf3n"),Object(c.b)("p",null,"Se deben configurar las siguientes variables de ambiente:"),Object(c.b)("table",null,Object(c.b)("thead",{parentName:"table"},Object(c.b)("tr",{parentName:"thead"},Object(c.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"variable"),Object(c.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"descripci\xf3n"))),Object(c.b)("tbody",{parentName:"table"},Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"CORE_URL"),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Url del servicio principal")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"DATABASE_URL"),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Url de conexi\xf3n a la base de datos")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"NODE_ENV"),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Ambiente en el que se encuentra")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"NODE_URL"),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Url del nodo Ethereum")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"CONTRACT_ADDRESS"),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Direcci\xf3n del Smart Contract")),Object(c.b)("tr",{parentName:"tbody"},Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"BACKOFFICE_URL"),Object(c.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Url del front-end del backoffice")))),Object(c.b)("h2",{id:"cobertura"},"Cobertura"),Object(c.b)("p",null,"El proyecto fue testeado con pruebas unitarias y de integraci\xf3n utilizando ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://cucumber.io/docs/gherkin/"}),"Gherkin")," logrando una cobertura mayor al 90%. Se puede ver el detalle de los reportes en ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://codecov.io/gh/BookBnB/payments-service"}),"codecov"),"."),Object(c.b)("img",{alt:"Arquitectura",src:"https://codecov.io/gh/BookBnB/payments-service/branch/develop/graph/sunburst.svg",style:{margin:"15px auto",display:"flex"}}),Object(c.b)("h2",{id:"arquitectura"},"Arquitectura"),Object(c.b)("p",null,"Este microservicio utiliza una ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://alistair.cockburn.us/hexagonal-architecture/"}),"arquitectura hexagonal")," para mantener desacoplada la l\xf3gica de negocio con el resto de las conexiones del servicio."),Object(c.b)("h2",{id:"openapi"},"OpenApi"),Object(c.b)("p",null,"Puede consultarse la especificaci\xf3n OpenApi en ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://payments-service-master.herokuapp.com/v1/api.json"}),"api.json")," o utilizando swagger en ",Object(c.b)("a",Object(n.a)({parentName:"p"},{href:"https://payments-service-master.herokuapp.com/v1/api-docs"}),"api-docs"),"."),Object(c.b)("iframe",{src:"https://payments-service-master.herokuapp.com/v1/api-docs",frameBorder:"0",allowFullScreen:!0,style:{width:"100%",height:"500px"}}))}s.isMDXComponent=!0},118:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var b=r.a.createContext({}),s=function(e){var t=r.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=s(e.components);return r.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,c=e.originalType,o=e.parentName,b=l(e,["components","mdxType","originalType","parentName"]),p=s(a),d=n,m=p["".concat(o,".").concat(d)]||p[d]||u[d]||c;return a?r.a.createElement(m,i(i({ref:t},b),{},{components:a})):r.a.createElement(m,i({ref:t},b))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var c=a.length,o=new Array(c);o[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:n,o[1]=i;for(var b=2;b<c;b++)o[b]=a[b];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"}}]);